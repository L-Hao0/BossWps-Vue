{"remainingRequest":"F:\\BossWps-Vue\\node_modules\\babel-loader\\lib\\index.js!F:\\BossWps-Vue\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\BossWps-Vue\\src\\components\\js\\dialog.js","dependencies":[{"path":"F:\\BossWps-Vue\\src\\components\\js\\dialog.js","mtime":1614756963777},{"path":"F:\\BossWps-Vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1614754141434},{"path":"F:\\BossWps-Vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1614754140596},{"path":"F:\\BossWps-Vue\\node_modules\\eslint-loader\\index.js","mtime":1614754145150}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFV0aWwgZnJvbSAiLi91dGlsLmpzIjsKCmZ1bmN0aW9uIG9uYnV0dG9uY2xpY2soaWRTdHIsIHBhcmFtKSB7CiAgc3dpdGNoIChpZFN0cikgewogICAgY2FzZSAiZ2V0RG9jTmFtZSI6CiAgICAgIHsKICAgICAgICB2YXIgZG9jID0gd3BzLkV0QXBwbGljYXRpb24oKS5BY3RpdmVXb3JrYm9vazsKCiAgICAgICAgaWYgKCFkb2MpIHsKICAgICAgICAgIHJldHVybiAi5b2T5YmN5rKh5pyJ5omT5byA5Lu75L2V5paH5qGjIjsKICAgICAgICB9CgogICAgICAgIHJldHVybiBkb2MuTmFtZTsKICAgICAgfQoKICAgIGNhc2UgImNyZWF0ZVRhc2tQYW5lIjoKICAgICAgewogICAgICAgIHZhciB0c0lkID0gd3BzLlBsdWdpblN0b3JhZ2UuZ2V0SXRlbSgidGFza3BhbmVfaWQiKTsKCiAgICAgICAgaWYgKCF0c0lkKSB7CiAgICAgICAgICB2YXIgdHNrcGFuZSA9IHdwcy5DcmVhdGVUYXNrUGFuZShVdGlsLkdldFVybFBhdGgoKSArICJ0YXNrcGFuZSIpOwogICAgICAgICAgdmFyIGlkID0gdHNrcGFuZS5JRDsKICAgICAgICAgIHdwcy5QbHVnaW5TdG9yYWdlLnNldEl0ZW0oInRhc2twYW5lX2lkIiwgaWQpOwogICAgICAgICAgdHNrcGFuZS5WaXNpYmxlID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIF90c2twYW5lID0gd3BzLkdldFRhc2tQYW5lKHRzSWQpOwoKICAgICAgICAgIF90c2twYW5lLlZpc2libGUgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICBjYXNlICJuZXdEb2MiOgogICAgICB7CiAgICAgICAgd3BzLkV0QXBwbGljYXRpb24oKS5Xb3JrYm9va3MuQWRkKCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICBjYXNlICJhZGRTdHJpbmciOgogICAgICB7CiAgICAgICAgdmFyIGN1clNoZWV0ID0gd3BzLkV0QXBwbGljYXRpb24oKS5BY3RpdmVTaGVldDsKCiAgICAgICAgaWYgKGN1clNoZWV0KSB7CiAgICAgICAgICBjdXJTaGVldC5DZWxscy5JdGVtKDEsIDEpLkZvcm11bGEgPSAiSGVsbG8sIHdwc+WKoOi9vemhuSEiICsgY3VyU2hlZXQuQ2VsbHMuSXRlbSgxLCAxKS5Gb3JtdWxhOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICBjYXNlICJjbG9zZURvYyI6CiAgICAgIHsKICAgICAgICBpZiAod3BzLkV0QXBwbGljYXRpb24oKS5Xb3JrYm9va3MuQ291bnQgPCAyKSB7CiAgICAgICAgICBhbGVydCgi5b2T5YmN5Y+q5pyJ5LiA5Liq5paH5qGj77yM5Yir5YWz5LqG44CCIik7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHZhciBfZG9jID0gd3BzLkV0QXBwbGljYXRpb24oKS5BY3RpdmVXb3JrYm9vazsKICAgICAgICBpZiAoX2RvYykgX2RvYy5DbG9zZSgpOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgY2FzZSAibWVudWVkIjoKICAgICAgewogICAgICAgIHZhciB0c0lkMiA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oInRhc2twYW5lX2lkMiIpOwoKICAgICAgICBpZiAoIXRzSWQyKSB7CiAgICAgICAgICB2YXIgdHNrcGFuZTIgPSB3cHMuQ3JlYXRlVGFza1BhbmUoVXRpbC5HZXRVcmxQYXRoKCkgKyAibWVudWVkIik7CiAgICAgICAgICB2YXIgaWQyID0gdHNrcGFuZTIuSUQ7CiAgICAgICAgICB3cHMuUGx1Z2luU3RvcmFnZS5zZXRJdGVtKCJ0YXNrcGFuZV9pZDIiLCBpZDIpOwogICAgICAgICAgdHNrcGFuZTIuVmlzaWJsZSA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBfdHNrcGFuZTIgPSB3cHMuR2V0VGFza1BhbmUodHNJZDIpOwoKICAgICAgICAgIF90c2twYW5lMi5WaXNpYmxlID0gIV90c2twYW5lMi5WaXNpYmxlOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICBjYXNlICJvcGVuV2ViIjoKICAgICAgewogICAgICAgIHdwcy5PQUFzc2lzdC5TaGVsbEV4ZWN1dGUocGFyYW0pOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgfQp9CgpleHBvcnQgZGVmYXVsdCB7CiAgb25idXR0b25jbGljazogb25idXR0b25jbGljawp9Ow=="},{"version":3,"sources":["F:/BossWps-Vue/src/components/js/dialog.js"],"names":["Util","onbuttonclick","idStr","param","doc","wps","EtApplication","ActiveWorkbook","Name","tsId","PluginStorage","getItem","tskpane","CreateTaskPane","GetUrlPath","id","ID","setItem","Visible","GetTaskPane","Workbooks","Add","curSheet","ActiveSheet","Cells","Item","Formula","Count","alert","Close","tsId2","tskpane2","id2","OAAssist","ShellExecute"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,WAAjB;;AAEA,SAASC,aAAT,CAAuBC,KAAvB,EAA8BC,KAA9B,EAAqC;AACjC,UAAQD,KAAR;AACI,SAAK,YAAL;AAAmB;AACf,YAAIE,GAAG,GAAGC,GAAG,CAACC,aAAJ,GAAoBC,cAA9B;;AACA,YAAI,CAACH,GAAL,EAAU;AACN,iBAAO,YAAP;AACH;;AACD,eAAOA,GAAG,CAACI,IAAX;AACH;;AACD,SAAK,gBAAL;AAAuB;AACnB,YAAIC,IAAI,GAAGJ,GAAG,CAACK,aAAJ,CAAkBC,OAAlB,CAA0B,aAA1B,CAAX;;AACA,YAAI,CAACF,IAAL,EAAW;AACP,cAAIG,OAAO,GAAGP,GAAG,CAACQ,cAAJ,CAAmBb,IAAI,CAACc,UAAL,KAAoB,UAAvC,CAAd;AACA,cAAIC,EAAE,GAAGH,OAAO,CAACI,EAAjB;AACAX,UAAAA,GAAG,CAACK,aAAJ,CAAkBO,OAAlB,CAA0B,aAA1B,EAAyCF,EAAzC;AACAH,UAAAA,OAAO,CAACM,OAAR,GAAkB,IAAlB;AACH,SALD,MAKO;AACH,cAAIN,QAAO,GAAGP,GAAG,CAACc,WAAJ,CAAgBV,IAAhB,CAAd;;AACAG,UAAAA,QAAO,CAACM,OAAR,GAAkB,IAAlB;AACH;;AACD;AACH;;AACD,SAAK,QAAL;AAAe;AACXb,QAAAA,GAAG,CAACC,aAAJ,GAAoBc,SAApB,CAA8BC,GAA9B;AACA;AACH;;AACD,SAAK,WAAL;AAAkB;AACd,YAAIC,QAAQ,GAAGjB,GAAG,CAACC,aAAJ,GAAoBiB,WAAnC;;AACA,YAAID,QAAJ,EAAc;AACVA,UAAAA,QAAQ,CAACE,KAAT,CAAeC,IAAf,CAAoB,CAApB,EAAuB,CAAvB,EAA0BC,OAA1B,GAAoC,mBAAmBJ,QAAQ,CAACE,KAAT,CAAeC,IAAf,CAAoB,CAApB,EAAuB,CAAvB,EAA0BC,OAAjF;AACH;;AACD;AACH;;AACD,SAAK,UAAL;AAAiB;AACb,YAAIrB,GAAG,CAACC,aAAJ,GAAoBc,SAApB,CAA8BO,KAA9B,GAAsC,CAA1C,EAA6C;AACzCC,UAAAA,KAAK,CAAC,eAAD,CAAL;AACA;AACH;;AAED,YAAIxB,IAAG,GAAGC,GAAG,CAACC,aAAJ,GAAoBC,cAA9B;AACA,YAAIH,IAAJ,EACIA,IAAG,CAACyB,KAAJ;AACJ;AACH;;AACP,SAAK,QAAL;AAAe;AACX,YAAIC,KAAK,GAAGzB,GAAG,CAACK,aAAJ,CAAkBC,OAAlB,CAA0B,cAA1B,CAAZ;;AACA,YAAI,CAACmB,KAAL,EAAY;AACR,cAAIC,QAAQ,GAAG1B,GAAG,CAACQ,cAAJ,CAAmBb,IAAI,CAACc,UAAL,KAAoB,QAAvC,CAAf;AACA,cAAIkB,GAAG,GAAGD,QAAQ,CAACf,EAAnB;AACAX,UAAAA,GAAG,CAACK,aAAJ,CAAkBO,OAAlB,CAA0B,cAA1B,EAA0Ce,GAA1C;AACAD,UAAAA,QAAQ,CAACb,OAAT,GAAmB,IAAnB;AACH,SALD,MAKO;AACH,cAAIa,SAAQ,GAAG1B,GAAG,CAACc,WAAJ,CAAgBW,KAAhB,CAAf;;AACAC,UAAAA,SAAQ,CAACb,OAAT,GAAmB,CAACa,SAAQ,CAACb,OAA7B;AACH;;AACD;AACH;;AACK,SAAK,SAAL;AAAgB;AACZb,QAAAA,GAAG,CAAC4B,QAAJ,CAAaC,YAAb,CAA0B/B,KAA1B;AACA;AACH;AA3DL;AA8DH;;AAED,eAAe;AACXF,EAAAA,aAAa,EAAbA;AADW,CAAf","sourcesContent":["import Util from \"./util.js\"\r\n\r\nfunction onbuttonclick(idStr, param) {\r\n    switch (idStr) {\r\n        case \"getDocName\": {\r\n            let doc = wps.EtApplication().ActiveWorkbook\r\n            if (!doc) {\r\n                return \"当前没有打开任何文档\"\r\n            }\r\n            return doc.Name;\r\n        }\r\n        case \"createTaskPane\": {\r\n            let tsId = wps.PluginStorage.getItem(\"taskpane_id\")\r\n            if (!tsId) {\r\n                let tskpane = wps.CreateTaskPane(Util.GetUrlPath() + \"taskpane\")\r\n                let id = tskpane.ID\r\n                wps.PluginStorage.setItem(\"taskpane_id\", id)\r\n                tskpane.Visible = true\r\n            } else {\r\n                let tskpane = wps.GetTaskPane(tsId)\r\n                tskpane.Visible = true\r\n            }\r\n            break\r\n        }\r\n        case \"newDoc\": {\r\n            wps.EtApplication().Workbooks.Add()\r\n            break\r\n        }\r\n        case \"addString\": {\r\n            let curSheet = wps.EtApplication().ActiveSheet;\r\n            if (curSheet) {\r\n                curSheet.Cells.Item(1, 1).Formula = \"Hello, wps加载项!\" + curSheet.Cells.Item(1, 1).Formula\r\n            }\r\n            break;\r\n        }\r\n        case \"closeDoc\": {\r\n            if (wps.EtApplication().Workbooks.Count < 2) {\r\n                alert(\"当前只有一个文档，别关了。\")\r\n                break\r\n            }\r\n\r\n            let doc = wps.EtApplication().ActiveWorkbook\r\n            if (doc)\r\n                doc.Close()\r\n            break\r\n        }\r\n\t\tcase \"menued\": {\r\n\t\t    let tsId2 = wps.PluginStorage.getItem(\"taskpane_id2\")\r\n\t\t    if (!tsId2) {\r\n\t\t        let tskpane2 = wps.CreateTaskPane(Util.GetUrlPath() + \"menued\")\r\n\t\t        let id2 = tskpane2.ID\r\n\t\t        wps.PluginStorage.setItem(\"taskpane_id2\", id2)\r\n\t\t        tskpane2.Visible = true\r\n\t\t    } else {\r\n\t\t        let tskpane2 = wps.GetTaskPane(tsId2)\r\n\t\t        tskpane2.Visible = !tskpane2.Visible\r\n\t\t    }\r\n\t\t    break\r\n\t\t}\r\n        case \"openWeb\": {\r\n            wps.OAAssist.ShellExecute(param)\r\n            break\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport default {\r\n    onbuttonclick\r\n}"]}]}