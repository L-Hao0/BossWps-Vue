{"remainingRequest":"D:\\xm\\BossWps-Vue\\BossWps-Vue\\node_modules\\babel-loader\\lib\\index.js!D:\\xm\\BossWps-Vue\\BossWps-Vue\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\xm\\BossWps-Vue\\BossWps-Vue\\src\\components\\ribbon.js","dependencies":[{"path":"D:\\xm\\BossWps-Vue\\BossWps-Vue\\src\\components\\ribbon.js","mtime":1614823468420},{"path":"D:\\xm\\BossWps-Vue\\BossWps-Vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\xm\\BossWps-Vue\\BossWps-Vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\xm\\BossWps-Vue\\BossWps-Vue\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90eXBlb2YgZnJvbSAiRDoveG0vQm9zc1dwcy1WdWUvQm9zc1dwcy1WdWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZiI7CmltcG9ydCBVdGlsIGZyb20gJy4vanMvdXRpbC5qcyc7CmltcG9ydCBTeXN0ZW1EZW1vIGZyb20gJy4vanMvc3lzdGVtZGVtby5qcyc7CmltcG9ydCBkaWFsb2cgZnJvbSAiLi4vY29tcG9uZW50cy9qcy9kaWFsb2cuanMiOyAvL+i/meS4quWHveaVsOWcqOaVtOS4qndwc+WKoOi9vemhueS4reaYr+esrOS4gOS4quaJp+ihjOeahAoKZnVuY3Rpb24gT25BZGRpbkxvYWQocmliYm9uVUkpIHsKICBpZiAoX3R5cGVvZih3cHMucmliYm9uVUkpICE9ICJvYmplY3QiKSB7CiAgICB3cHMucmliYm9uVUkgPSByaWJib25VSTsKICB9CgogIGlmIChfdHlwZW9mKHdwcy5FbnVtKSAhPSAib2JqZWN0IikgewogICAgLy8g5aaC5p6c5rKh5pyJ5YaF572u5p6a5Li+5YC8CiAgICB3cHMuRW51bSA9IFV0aWwuV1BTX0VudW07CiAgfSAvL+i/meWHoOS4quWvvOWHuuWHveaVsOaYr+e7meWklumDqOS4muWKoeezu+e7n+iwg+eUqOeahAoKCiAgd2luZG93Lm9wZW5PZmZpY2VGaWxlRnJvbVN5c3RlbURlbW8gPSBTeXN0ZW1EZW1vLm9wZW5PZmZpY2VGaWxlRnJvbVN5c3RlbURlbW87CiAgd2luZG93Lkludm9rZUZyb21TeXN0ZW1EZW1vID0gU3lzdGVtRGVtby5JbnZva2VGcm9tU3lzdGVtRGVtbzsKICB3cHMuUGx1Z2luU3RvcmFnZS5zZXRJdGVtKCJFbmFibGVGbGFnIiwgZmFsc2UpOyAvL+W+gFBsdWdpblN0b3JhZ2XkuK3orr7nva7kuIDkuKrmoIforrDvvIznlKjkuo7mjqfliLbkuKTkuKrmjInpkq7nmoTnva7ngbAKCiAgd3BzLlBsdWdpblN0b3JhZ2Uuc2V0SXRlbSgiQXBpRXZlbnRGbGFnIiwgZmFsc2UpOyAvL+W+gFBsdWdpblN0b3JhZ2XkuK3orr7nva7kuIDkuKrmoIforrDvvIznlKjkuo7mjqfliLZBcGlFdmVudOeahOaMiemSrmxhYmVsCgogIHJldHVybiB0cnVlOwp9IC8vIHZhciBXZWJOb3RpZnljb3VudCA9IDA7CgoKZnVuY3Rpb24gT25BY3Rpb24oY29udHJvbCkgewogIHZhciBlbGVJZCA9IGNvbnRyb2wuSWQ7CgogIHN3aXRjaCAoZWxlSWQpIHsKICAgIGNhc2UgImJ0blNob3dNc2ciOgogICAgICB7CiAgICAgICAgdmFyIGRvYyA9IHdwcy5FdEFwcGxpY2F0aW9uKCkuQWN0aXZlV29ya2Jvb2s7CgogICAgICAgIGlmICghZG9jKSB7CiAgICAgICAgICBhbGVydCgi5b2T5YmN5rKh5pyJ5omT5byA5Lu75L2V5paH5qGjIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBhbGVydChkb2MuTmFtZSk7CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAiYnRuSXNFbmJhYmxlIjoKICAgICAgewogICAgICAgIHZhciBiRmxhZyA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oIkVuYWJsZUZsYWciKTsKICAgICAgICB3cHMuUGx1Z2luU3RvcmFnZS5zZXRJdGVtKCJFbmFibGVGbGFnIiwgIWJGbGFnKTsgLy/pgJrnn6V3cHPliLfmlrDku6XkuIvlh6DkuKrmjInppbDnmoTnirbmgIEKCiAgICAgICAgd3BzLnJpYmJvblVJLkludmFsaWRhdGVDb250cm9sKCJidG5Jc0VuYmFibGUiKTsKICAgICAgICB3cHMucmliYm9uVUkuSW52YWxpZGF0ZUNvbnRyb2woImJ0blNob3dEaWFsb2ciKTsKICAgICAgICB3cHMucmliYm9uVUkuSW52YWxpZGF0ZUNvbnRyb2woImJ0blNob3dUYXNrUGFuZSIpOyAvL3dwcy5yaWJib25VSS5JbnZhbGlkYXRlKCk7IOi/meihjOS7o+eggeaJk+W8gOWImeaYr+WIt+aWsOaJgOacieeahOaMiemSrueKtuaAgQoKICAgICAgICBicmVhazsKICAgICAgfQoKICAgIGNhc2UgImJ0blNob3dEaWFsb2ciOgogICAgICB3cHMuU2hvd0RpYWxvZyhVdGlsLkdldFVybFBhdGgoKSArICJkaWFsb2ciLCAi6L+Z5piv5LiA5Liq5a+56K+d5qGG572R6aG1IiwgNDAwICogd2luZG93LmRldmljZVBpeGVsUmF0aW8sIDQwMCAqIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLCBmYWxzZSk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgIm1lbnVlZCI6CiAgICAgIHsKICAgICAgICBkaWFsb2cub25idXR0b25jbGljaygibWVudWVkIik7CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAiYnRuQXBpRXZlbnQiOgogICAgICB7CiAgICAgICAgdmFyIF9iRmxhZyA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oIkFwaUV2ZW50RmxhZyIpOwoKICAgICAgICB2YXIgYlJlZ2lzdGVyID0gX2JGbGFnID8gZmFsc2UgOiB0cnVlOwogICAgICAgIHdwcy5QbHVnaW5TdG9yYWdlLnNldEl0ZW0oIkFwaUV2ZW50RmxhZyIsIGJSZWdpc3Rlcik7CgogICAgICAgIGlmIChiUmVnaXN0ZXIpIHsKICAgICAgICAgIHdwcy5BcGlFdmVudC5BZGRBcGlFdmVudExpc3RlbmVyKCdOZXdXb3JrYm9vaycsICdyaWJib24uT25OZXdEb2N1bWVudEFwaUV2ZW50Jyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdwcy5BcGlFdmVudC5SZW1vdmVBcGlFdmVudExpc3RlbmVyKCdOZXdXb3JrYm9vaycsICdyaWJib24uT25OZXdEb2N1bWVudEFwaUV2ZW50Jyk7CiAgICAgICAgfQoKICAgICAgICB3cHMucmliYm9uVUkuSW52YWxpZGF0ZUNvbnRyb2woImJ0bkFwaUV2ZW50Iik7CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAiZGVuZ2x1IjoKICAgICAgewogICAgICAgIHdwcy5TaG93RGlhbG9nKFV0aWwuR2V0VXJsUGF0aCgpICsgImxvZ2luIiwgIuasoui/jueZu+W9lSIsIDkwMCAqIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLCA2MDAgKiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbywgZmFsc2UpOwogICAgICB9CiAgICAgIGJyZWFrOwoKICAgIGRlZmF1bHQ6CiAgICAgIGJyZWFrOwogIH0KCiAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIEdldEltYWdlKGNvbnRyb2wpIHsKICB2YXIgZWxlSWQgPSBjb250cm9sLklkOwoKICBzd2l0Y2ggKGVsZUlkKSB7CiAgICBjYXNlICJidG5TaG93TXNnIjoKICAgICAgcmV0dXJuICJpbWFnZXMvMS5zdmciOwoKICAgIGNhc2UgImJ0blNob3dEaWFsb2ciOgogICAgICByZXR1cm4gImltYWdlcy8yLnN2ZyI7CgogICAgY2FzZSAiYnRuU2hvd1Rhc2tQYW5lIjoKICAgICAgcmV0dXJuICJpbWFnZXMvMy5zdmciOwoKICAgIGRlZmF1bHQ6CiAgfQoKICByZXR1cm4gImltYWdlcy9uZXdGcm9tVGVtcC5zdmciOwp9CgpmdW5jdGlvbiBPbkdldEVuYWJsZWQoY29udHJvbCkgewogIHZhciBlbGVJZCA9IGNvbnRyb2wuSWQ7CgogIHN3aXRjaCAoZWxlSWQpIHsKICAgIGNhc2UgImJ0blNob3dNc2ciOgogICAgICByZXR1cm4gdHJ1ZTsKICAgIC8vIGNhc2UgImJ0blNob3dEaWFsb2ciOgogICAgLy8gICAgIHsKICAgIC8vICAgICAgICAgbGV0IGJGbGFnID0gd3BzLlBsdWdpblN0b3JhZ2UuZ2V0SXRlbSgiRW5hYmxlRmxhZyIpCiAgICAvLyAgICAgICAgIHJldHVybiBiRmxhZwogICAgLy8gICAgIH0KCiAgICBjYXNlICJtZW51ZWQiOgogICAgICB7CiAgICAgICAgdmFyIGJGbGFnID0gd3BzLlBsdWdpblN0b3JhZ2UuZ2V0SXRlbSgiRW5hYmxlRmxhZyIpOwogICAgICAgIHJldHVybiBiRmxhZzsKICAgICAgfQoKICAgIGRlZmF1bHQ6CiAgICAgIGJyZWFrOwogIH0KCiAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIE9uR2V0VmlzaWJsZShjb250cm9sKSB7CiAgdmFyIGVsZUlkID0gY29udHJvbC5JZDsKICBjb25zb2xlLmxvZyhlbGVJZCk7CiAgcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIE9uR2V0TGFiZWwoY29udHJvbCkgewogIHZhciBlbGVJZCA9IGNvbnRyb2wuSWQ7CgogIHN3aXRjaCAoZWxlSWQpIHsKICAgIGNhc2UgImJ0bklzRW5iYWJsZSI6CiAgICAgIHsKICAgICAgICB2YXIgYkZsYWcgPSB3cHMuUGx1Z2luU3RvcmFnZS5nZXRJdGVtKCJFbmFibGVGbGFnIik7CiAgICAgICAgcmV0dXJuIGJGbGFnID8gIuaMiemSrkRpc2FibGUiIDogIuaMiemSrkVuYWJsZSI7CiAgICAgIH0KCiAgICBjYXNlICJidG5BcGlFdmVudCI6CiAgICAgIHsKICAgICAgICB2YXIgX2JGbGFnMiA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oIkFwaUV2ZW50RmxhZyIpOwoKICAgICAgICByZXR1cm4gX2JGbGFnMiA/ICLmuIXpmaTmlrDlu7rmlofku7bkuovku7YiIDogIuazqOWGjOaWsOW7uuaWh+S7tuS6i+S7tiI7CiAgICAgIH0KICB9CgogIHJldHVybiAiIjsKfQoKZnVuY3Rpb24gT25OZXdEb2N1bWVudEFwaUV2ZW50KGRvYykgewogIGFsZXJ0KCLmlrDlu7rmlofku7bkuovku7blk43lupTvvIzlj5bmlofku7blkI06ICIgKyBkb2MuTmFtZSk7Cn0gLy/ov5nkupvlh73mlbDmmK/nu5l3cHPlrqLmiLfnq6/osIPnlKjnmoQKCgpleHBvcnQgZGVmYXVsdCB7CiAgT25BZGRpbkxvYWQ6IE9uQWRkaW5Mb2FkLAogIE9uQWN0aW9uOiBPbkFjdGlvbiwKICBHZXRJbWFnZTogR2V0SW1hZ2UsCiAgT25HZXRFbmFibGVkOiBPbkdldEVuYWJsZWQsCiAgT25HZXRWaXNpYmxlOiBPbkdldFZpc2libGUsCiAgT25HZXRMYWJlbDogT25HZXRMYWJlbCwKICBPbk5ld0RvY3VtZW50QXBpRXZlbnQ6IE9uTmV3RG9jdW1lbnRBcGlFdmVudAp9Ow=="},{"version":3,"sources":["D:/xm/BossWps-Vue/BossWps-Vue/src/components/ribbon.js"],"names":["Util","SystemDemo","dialog","OnAddinLoad","ribbonUI","wps","Enum","WPS_Enum","window","openOfficeFileFromSystemDemo","InvokeFromSystemDemo","PluginStorage","setItem","OnAction","control","eleId","Id","doc","EtApplication","ActiveWorkbook","alert","Name","bFlag","getItem","InvalidateControl","ShowDialog","GetUrlPath","devicePixelRatio","onbuttonclick","bRegister","ApiEvent","AddApiEventListener","RemoveApiEventListener","GetImage","OnGetEnabled","OnGetVisible","console","log","OnGetLabel","OnNewDocumentApiEvent"],"mappings":"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","sourcesContent":["import Util from './js/util.js'\r\nimport SystemDemo from './js/systemdemo.js'\r\nimport dialog from \"../components/js/dialog.js\"\r\n\r\n//这个函数在整个wps加载项中是第一个执行的\r\nfunction OnAddinLoad(ribbonUI){\r\n    if (typeof (wps.ribbonUI) != \"object\"){\r\n\t\twps.ribbonUI = ribbonUI\r\n    }\r\n    \r\n    if (typeof (wps.Enum) != \"object\") { // 如果没有内置枚举值\r\n        wps.Enum = Util.WPS_Enum\r\n    }\r\n\r\n    //这几个导出函数是给外部业务系统调用的\r\n    window.openOfficeFileFromSystemDemo = SystemDemo.openOfficeFileFromSystemDemo\r\n    window.InvokeFromSystemDemo = SystemDemo.InvokeFromSystemDemo\r\n\r\n    wps.PluginStorage.setItem(\"EnableFlag\", false) //往PluginStorage中设置一个标记，用于控制两个按钮的置灰\r\n    wps.PluginStorage.setItem(\"ApiEventFlag\", false) //往PluginStorage中设置一个标记，用于控制ApiEvent的按钮label\r\n    return true\r\n}\r\n\r\n// var WebNotifycount = 0;\r\nfunction OnAction(control) {\r\n    const eleId = control.Id;\r\n    switch (eleId) {\r\n        case \"btnShowMsg\":\r\n            {\r\n                const doc = wps.EtApplication().ActiveWorkbook\r\n                if (!doc) {\r\n                    alert(\"当前没有打开任何文档\")\r\n                    return\r\n                }\r\n                alert(doc.Name) \r\n            }\r\n            break;\r\n        case \"btnIsEnbable\":\r\n            {\r\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\r\n                wps.PluginStorage.setItem(\"EnableFlag\", !bFlag)\r\n                \r\n                //通知wps刷新以下几个按饰的状态\r\n                wps.ribbonUI.InvalidateControl(\"btnIsEnbable\")\r\n                wps.ribbonUI.InvalidateControl(\"btnShowDialog\") \r\n                wps.ribbonUI.InvalidateControl(\"btnShowTaskPane\") \r\n                //wps.ribbonUI.Invalidate(); 这行代码打开则是刷新所有的按钮状态\r\n                break\r\n            }\r\n        case \"btnShowDialog\":\r\n            wps.ShowDialog(Util.GetUrlPath() + \"dialog\", \"这是一个对话框网页\", 400 * window.devicePixelRatio, 400 * window.devicePixelRatio, false)\r\n            break\r\n        case \"menued\":\r\n            {\r\n                dialog.onbuttonclick(\"menued\")\r\n            }\r\n            break\r\n        case \"btnApiEvent\":\r\n            {\r\n                let bFlag = wps.PluginStorage.getItem(\"ApiEventFlag\")\r\n                let bRegister = bFlag ? false : true\r\n                wps.PluginStorage.setItem(\"ApiEventFlag\", bRegister)\r\n                if (bRegister){\r\n                    wps.ApiEvent.AddApiEventListener('NewWorkbook', 'ribbon.OnNewDocumentApiEvent')\r\n                }\r\n                else{\r\n                    wps.ApiEvent.RemoveApiEventListener('NewWorkbook', 'ribbon.OnNewDocumentApiEvent')\r\n                }\r\n                \r\n                wps.ribbonUI.InvalidateControl(\"btnApiEvent\") \r\n            }\r\n            break\r\n        case \"denglu\":\r\n            {\r\n                wps.ShowDialog(Util.GetUrlPath() + \"login\", \"欢迎登录\", 900 * window.devicePixelRatio, 600 * window.devicePixelRatio, false)\r\n            }\r\n            break\r\n\r\n        default:\r\n            break\r\n    }\r\n    return true\r\n}\r\n\r\nfunction GetImage(control) {\r\n    const eleId = control.Id\r\n    switch (eleId) {\r\n        case \"btnShowMsg\":\r\n            return \"images/1.svg\"\r\n        case \"btnShowDialog\":\r\n            return \"images/2.svg\"\r\n        case \"btnShowTaskPane\":\r\n            return \"images/3.svg\"\r\n        default:\r\n    }\r\n    return \"images/newFromTemp.svg\"\r\n}\r\n\r\nfunction OnGetEnabled(control) {\r\n    const eleId = control.Id\r\n    switch (eleId) {\r\n        case \"btnShowMsg\":\r\n            return true\r\n        // case \"btnShowDialog\":\r\n        //     {\r\n        //         let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\r\n        //         return bFlag\r\n        //     }\r\n        case \"menued\":\r\n            {\r\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\r\n                return bFlag\r\n            }\r\n        default:\r\n            break\r\n    }\r\n    return true\r\n}\r\n\r\nfunction OnGetVisible(control){\r\n    const eleId = control.Id\r\n    console.log(eleId)\r\n    return true\r\n}\r\n\r\nfunction OnGetLabel(control){\r\n    const eleId = control.Id\r\n    switch (eleId) {\r\n        case \"btnIsEnbable\":\r\n            {\r\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\r\n                return bFlag ?  \"按钮Disable\" : \"按钮Enable\"\r\n            }\r\n        case \"btnApiEvent\":\r\n            {\r\n                let bFlag = wps.PluginStorage.getItem(\"ApiEventFlag\")\r\n                return bFlag ? \"清除新建文件事件\" : \"注册新建文件事件\"\r\n            }    \r\n    }\r\n    return \"\"\r\n}\r\n\r\nfunction OnNewDocumentApiEvent(doc){\r\n    alert(\"新建文件事件响应，取文件名: \" + doc.Name)\r\n}\r\n\r\n\r\n//这些函数是给wps客户端调用的\r\nexport default {\r\n    OnAddinLoad,\r\n    OnAction,\r\n    GetImage,\r\n    OnGetEnabled,\r\n    OnGetVisible,\r\n    OnGetLabel,\r\n    OnNewDocumentApiEvent\r\n};\r\n\r\n\r\n\r\n\r\n"]}]}