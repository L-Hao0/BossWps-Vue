{"remainingRequest":"E:\\tmp\\BossWps-Vue\\node_modules\\babel-loader\\lib\\index.js!E:\\tmp\\BossWps-Vue\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\tmp\\BossWps-Vue\\src\\components\\js\\taskpane.js","dependencies":[{"path":"E:\\tmp\\BossWps-Vue\\src\\components\\js\\taskpane.js","mtime":499162500000},{"path":"E:\\tmp\\BossWps-Vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\tmp\\BossWps-Vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\tmp\\BossWps-Vue\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90eXBlb2YgZnJvbSAiRTovdG1wL0Jvc3NXcHMtVnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90eXBlb2YiOwppbXBvcnQgVXRpbCBmcm9tICIuL3V0aWwuanMiOwoKZnVuY3Rpb24gb25idXR0b25jbGljayhpZFN0ciwgcGFyYW0pIHsKICBpZiAoX3R5cGVvZih3cHMuRW51bSkgIT0gIm9iamVjdCIpIHsKICAgIC8vIOWmguaenOayoeacieWGhee9ruaemuS4vuWAvAogICAgd3BzLkVudW0gPSBVdGlsLldQU19FbnVtOwogIH0KCiAgc3dpdGNoIChpZFN0cikgewogICAgY2FzZSAiZG9ja0xlZnQiOgogICAgICB7CiAgICAgICAgdmFyIHRzSWQgPSB3cHMuUGx1Z2luU3RvcmFnZS5nZXRJdGVtKCJ0YXNrcGFuZV9pZCIpOwoKICAgICAgICBpZiAodHNJZCkgewogICAgICAgICAgdmFyIHRza3BhbmUgPSB3cHMuR2V0VGFza1BhbmUodHNJZCk7CiAgICAgICAgICB0c2twYW5lLkRvY2tQb3NpdGlvbiA9IHdwcy5FbnVtLm1zb0NUUERvY2tQb3NpdGlvbkxlZnQ7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgICAgfQoKICAgIGNhc2UgImRvY2tSaWdodCI6CiAgICAgIHsKICAgICAgICB2YXIgX3RzSWQgPSB3cHMuUGx1Z2luU3RvcmFnZS5nZXRJdGVtKCJ0YXNrcGFuZV9pZCIpOwoKICAgICAgICBpZiAoX3RzSWQpIHsKICAgICAgICAgIHZhciBfdHNrcGFuZSA9IHdwcy5HZXRUYXNrUGFuZShfdHNJZCk7CgogICAgICAgICAgX3Rza3BhbmUuRG9ja1Bvc2l0aW9uID0gd3BzLkVudW0ubXNvQ1RQRG9ja1Bvc2l0aW9uUmlnaHQ7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgICAgfQoKICAgIGNhc2UgImhpZGVUYXNrUGFuZSI6CiAgICAgIHsKICAgICAgICB2YXIgX3RzSWQyID0gd3BzLlBsdWdpblN0b3JhZ2UuZ2V0SXRlbSgidGFza3BhbmVfaWQiKTsKCiAgICAgICAgaWYgKF90c0lkMikgewogICAgICAgICAgdmFyIF90c2twYW5lMiA9IHdwcy5HZXRUYXNrUGFuZShfdHNJZDIpOwoKICAgICAgICAgIF90c2twYW5lMi5WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgICAgfQoKICAgIGNhc2UgImFkZFN0cmluZyI6CiAgICAgIHsKICAgICAgICB2YXIgY3VyU2hlZXQgPSB3cHMuRXRBcHBsaWNhdGlvbigpLkFjdGl2ZVNoZWV0OwoKICAgICAgICBpZiAoY3VyU2hlZXQpIHsKICAgICAgICAgIGN1clNoZWV0LkNlbGxzLkl0ZW0oMSwgMSkuRm9ybXVsYSA9ICJIZWxsbywgd3Bz5Yqg6L296aG5ISIgKyBjdXJTaGVldC5DZWxscy5JdGVtKDEsIDEpLkZvcm11bGE7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgICAgfQoKICAgIGNhc2UgImdldERvY05hbWUiOgogICAgICB7CiAgICAgICAgdmFyIGRvYyA9IHdwcy5FdEFwcGxpY2F0aW9uKCkuQWN0aXZlV29ya2Jvb2s7CgogICAgICAgIGlmICghZG9jKSB7CiAgICAgICAgICByZXR1cm4gIuW9k+WJjeayoeacieaJk+W8gOS7u+S9leaWh+ahoyI7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZG9jLk5hbWU7CiAgICAgIH0KCiAgICBjYXNlICJvcGVuV2ViIjoKICAgICAgewogICAgICAgIHdwcy5PQUFzc2lzdC5TaGVsbEV4ZWN1dGUocGFyYW0pOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgfQp9CgpleHBvcnQgZGVmYXVsdCB7CiAgb25idXR0b25jbGljazogb25idXR0b25jbGljawp9Ow=="},{"version":3,"sources":["E:/tmp/BossWps-Vue/src/components/js/taskpane.js"],"names":["Util","onbuttonclick","idStr","param","wps","Enum","WPS_Enum","tsId","PluginStorage","getItem","tskpane","GetTaskPane","DockPosition","msoCTPDockPositionLeft","msoCTPDockPositionRight","Visible","curSheet","EtApplication","ActiveSheet","Cells","Item","Formula","doc","ActiveWorkbook","Name","OAAssist","ShellExecute"],"mappings":";AAAA,OAAOA,IAAP,MAAiB,WAAjB;;AAEA,SAASC,aAAT,CAAuBC,KAAvB,EAA8BC,KAA9B,EACA;AACI,MAAI,QAAQC,GAAG,CAACC,IAAZ,KAAqB,QAAzB,EAAmC;AAAE;AACjCD,IAAAA,GAAG,CAACC,IAAJ,GAAWL,IAAI,CAACM,QAAhB;AACH;;AACD,UAAOJ,KAAP;AAEI,SAAK,UAAL;AAAgB;AACZ,YAAIK,IAAI,GAAGH,GAAG,CAACI,aAAJ,CAAkBC,OAAlB,CAA0B,aAA1B,CAAX;;AACA,YAAIF,IAAJ,EAAS;AACL,cAAIG,OAAO,GAAGN,GAAG,CAACO,WAAJ,CAAgBJ,IAAhB,CAAd;AACAG,UAAAA,OAAO,CAACE,YAAR,GAAuBR,GAAG,CAACC,IAAJ,CAASQ,sBAAhC;AACH;;AACD;AACC;;AACL,SAAK,WAAL;AAAiB;AACb,YAAIN,KAAI,GAAGH,GAAG,CAACI,aAAJ,CAAkBC,OAAlB,CAA0B,aAA1B,CAAX;;AACA,YAAIF,KAAJ,EAAS;AACL,cAAIG,QAAO,GAAGN,GAAG,CAACO,WAAJ,CAAgBJ,KAAhB,CAAd;;AACAG,UAAAA,QAAO,CAACE,YAAR,GAAuBR,GAAG,CAACC,IAAJ,CAASS,uBAAhC;AACH;;AACD;AACH;;AACD,SAAK,cAAL;AAAoB;AAChB,YAAIP,MAAI,GAAGH,GAAG,CAACI,aAAJ,CAAkBC,OAAlB,CAA0B,aAA1B,CAAX;;AACA,YAAIF,MAAJ,EAAS;AACL,cAAIG,SAAO,GAAGN,GAAG,CAACO,WAAJ,CAAgBJ,MAAhB,CAAd;;AACAG,UAAAA,SAAO,CAACK,OAAR,GAAkB,KAAlB;AACH;;AACD;AACH;;AACD,SAAK,WAAL;AAAiB;AACb,YAAIC,QAAQ,GAAGZ,GAAG,CAACa,aAAJ,GAAoBC,WAAnC;;AACA,YAAIF,QAAJ,EAAa;AACTA,UAAAA,QAAQ,CAACG,KAAT,CAAeC,IAAf,CAAoB,CAApB,EAAuB,CAAvB,EAA0BC,OAA1B,GAAkC,mBAAmBL,QAAQ,CAACG,KAAT,CAAeC,IAAf,CAAoB,CAApB,EAAuB,CAAvB,EAA0BC,OAA/E;AACH;;AACD;AACH;;AACD,SAAK,YAAL;AAAkB;AACd,YAAIC,GAAG,GAAGlB,GAAG,CAACa,aAAJ,GAAoBM,cAA9B;;AACA,YAAI,CAACD,GAAL,EAAS;AACL,iBAAO,YAAP;AACH;;AACD,eAAOA,GAAG,CAACE,IAAX;AACH;;AACD,SAAK,SAAL;AAAgB;AACZpB,QAAAA,GAAG,CAACqB,QAAJ,CAAaC,YAAb,CAA0BvB,KAA1B;AACA;AACH;AA3CL;AA6CH;;AAED,eAAc;AACVF,EAAAA,aAAa,EAAbA;AADU,CAAd","sourcesContent":["import Util from \"./util.js\"\r\n\r\nfunction onbuttonclick(idStr, param)\r\n{\r\n    if (typeof (wps.Enum) != \"object\") { // 如果没有内置枚举值\r\n        wps.Enum = Util.WPS_Enum\r\n    }\r\n    switch(idStr)\r\n    {\r\n        case \"dockLeft\":{\r\n            let tsId = wps.PluginStorage.getItem(\"taskpane_id\")\r\n            if (tsId){\r\n                let tskpane = wps.GetTaskPane(tsId)\r\n                tskpane.DockPosition = wps.Enum.msoCTPDockPositionLeft\r\n            }\r\n            break\r\n            }\r\n        case \"dockRight\":{\r\n            let tsId = wps.PluginStorage.getItem(\"taskpane_id\")\r\n            if (tsId){\r\n                let tskpane = wps.GetTaskPane(tsId)\r\n                tskpane.DockPosition = wps.Enum.msoCTPDockPositionRight\r\n            }\r\n            break\r\n        }\r\n        case \"hideTaskPane\":{\r\n            let tsId = wps.PluginStorage.getItem(\"taskpane_id\")\r\n            if (tsId){\r\n                let tskpane = wps.GetTaskPane(tsId)\r\n                tskpane.Visible = false\r\n            }\r\n            break\r\n        }\r\n        case \"addString\":{\r\n            let curSheet = wps.EtApplication().ActiveSheet;\r\n            if (curSheet){\r\n                curSheet.Cells.Item(1, 1).Formula=\"Hello, wps加载项!\" + curSheet.Cells.Item(1, 1).Formula\r\n            }\r\n            break;\r\n        }\r\n        case \"getDocName\":{\r\n            let doc = wps.EtApplication().ActiveWorkbook\r\n            if (!doc){\r\n                return \"当前没有打开任何文档\"\r\n            }\r\n            return doc.Name\r\n        }\r\n        case \"openWeb\": {\r\n            wps.OAAssist.ShellExecute(param)\r\n            break\r\n        }\r\n    }\r\n}\r\n\r\nexport default{\r\n    onbuttonclick\r\n}"]}]}