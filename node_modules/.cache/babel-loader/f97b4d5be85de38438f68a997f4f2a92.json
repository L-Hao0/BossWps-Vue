{"remainingRequest":"E:\\tmp\\BossWps\\node_modules\\babel-loader\\lib\\index.js!E:\\tmp\\BossWps\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\tmp\\BossWps\\src\\components\\js\\dialog.js","dependencies":[{"path":"E:\\tmp\\BossWps\\src\\components\\js\\dialog.js","mtime":499162500000},{"path":"E:\\tmp\\BossWps\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\tmp\\BossWps\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\tmp\\BossWps\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFV0aWwgZnJvbSAiLi91dGlsLmpzIjsKCmZ1bmN0aW9uIG9uYnV0dG9uY2xpY2soaWRTdHIsIHBhcmFtKSB7CiAgc3dpdGNoIChpZFN0cikgewogICAgY2FzZSAiZ2V0RG9jTmFtZSI6CiAgICAgIHsKICAgICAgICB2YXIgZG9jID0gd3BzLkV0QXBwbGljYXRpb24oKS5BY3RpdmVXb3JrYm9vazsKCiAgICAgICAgaWYgKCFkb2MpIHsKICAgICAgICAgIHJldHVybiAi5b2T5YmN5rKh5pyJ5omT5byA5Lu75L2V5paH5qGjIjsKICAgICAgICB9CgogICAgICAgIHJldHVybiBkb2MuTmFtZTsKICAgICAgfQoKICAgIGNhc2UgImNyZWF0ZVRhc2tQYW5lIjoKICAgICAgewogICAgICAgIHZhciB0c0lkID0gd3BzLlBsdWdpblN0b3JhZ2UuZ2V0SXRlbSgidGFza3BhbmVfaWQiKTsKCiAgICAgICAgaWYgKCF0c0lkKSB7CiAgICAgICAgICB2YXIgdHNrcGFuZSA9IHdwcy5DcmVhdGVUYXNrUGFuZShVdGlsLkdldFVybFBhdGgoKSArICJ0YXNrcGFuZSIpOwogICAgICAgICAgdmFyIGlkID0gdHNrcGFuZS5JRDsKICAgICAgICAgIHdwcy5QbHVnaW5TdG9yYWdlLnNldEl0ZW0oInRhc2twYW5lX2lkIiwgaWQpOwogICAgICAgICAgdHNrcGFuZS5WaXNpYmxlID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIF90c2twYW5lID0gd3BzLkdldFRhc2tQYW5lKHRzSWQpOwoKICAgICAgICAgIF90c2twYW5lLlZpc2libGUgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICBjYXNlICJuZXdEb2MiOgogICAgICB7CiAgICAgICAgd3BzLkV0QXBwbGljYXRpb24oKS5Xb3JrYm9va3MuQWRkKCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICBjYXNlICJhZGRTdHJpbmciOgogICAgICB7CiAgICAgICAgdmFyIGN1clNoZWV0ID0gd3BzLkV0QXBwbGljYXRpb24oKS5BY3RpdmVTaGVldDsKCiAgICAgICAgaWYgKGN1clNoZWV0KSB7CiAgICAgICAgICBjdXJTaGVldC5DZWxscy5JdGVtKDEsIDEpLkZvcm11bGEgPSAiSGVsbG8sIHdwc+WKoOi9vemhuSEiICsgY3VyU2hlZXQuQ2VsbHMuSXRlbSgxLCAxKS5Gb3JtdWxhOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICBjYXNlICJjbG9zZURvYyI6CiAgICAgIHsKICAgICAgICBpZiAod3BzLkV0QXBwbGljYXRpb24oKS5Xb3JrYm9va3MuQ291bnQgPCAyKSB7CiAgICAgICAgICBhbGVydCgi5b2T5YmN5Y+q5pyJ5LiA5Liq5paH5qGj77yM5Yir5YWz5LqG44CCIik7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHZhciBfZG9jID0gd3BzLkV0QXBwbGljYXRpb24oKS5BY3RpdmVXb3JrYm9vazsKICAgICAgICBpZiAoX2RvYykgX2RvYy5DbG9zZSgpOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgY2FzZSAib3BlbldlYiI6CiAgICAgIHsKICAgICAgICB3cHMuT0FBc3Npc3QuU2hlbGxFeGVjdXRlKHBhcmFtKTsKICAgICAgICBicmVhazsKICAgICAgfQogIH0KfQoKZXhwb3J0IGRlZmF1bHQgewogIG9uYnV0dG9uY2xpY2s6IG9uYnV0dG9uY2xpY2sKfTs="},{"version":3,"sources":["E:/tmp/BossWps/src/components/js/dialog.js"],"names":["Util","onbuttonclick","idStr","param","doc","wps","EtApplication","ActiveWorkbook","Name","tsId","PluginStorage","getItem","tskpane","CreateTaskPane","GetUrlPath","id","ID","setItem","Visible","GetTaskPane","Workbooks","Add","curSheet","ActiveSheet","Cells","Item","Formula","Count","alert","Close","OAAssist","ShellExecute"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,WAAjB;;AAEA,SAASC,aAAT,CAAuBC,KAAvB,EAA8BC,KAA9B,EAAqC;AACjC,UAAQD,KAAR;AACI,SAAK,YAAL;AAAmB;AACf,YAAIE,GAAG,GAAGC,GAAG,CAACC,aAAJ,GAAoBC,cAA9B;;AACA,YAAI,CAACH,GAAL,EAAU;AACN,iBAAO,YAAP;AACH;;AACD,eAAOA,GAAG,CAACI,IAAX;AACH;;AACD,SAAK,gBAAL;AAAuB;AACnB,YAAIC,IAAI,GAAGJ,GAAG,CAACK,aAAJ,CAAkBC,OAAlB,CAA0B,aAA1B,CAAX;;AACA,YAAI,CAACF,IAAL,EAAW;AACP,cAAIG,OAAO,GAAGP,GAAG,CAACQ,cAAJ,CAAmBb,IAAI,CAACc,UAAL,KAAoB,UAAvC,CAAd;AACA,cAAIC,EAAE,GAAGH,OAAO,CAACI,EAAjB;AACAX,UAAAA,GAAG,CAACK,aAAJ,CAAkBO,OAAlB,CAA0B,aAA1B,EAAyCF,EAAzC;AACAH,UAAAA,OAAO,CAACM,OAAR,GAAkB,IAAlB;AACH,SALD,MAKO;AACH,cAAIN,QAAO,GAAGP,GAAG,CAACc,WAAJ,CAAgBV,IAAhB,CAAd;;AACAG,UAAAA,QAAO,CAACM,OAAR,GAAkB,IAAlB;AACH;;AACD;AACH;;AACD,SAAK,QAAL;AAAe;AACXb,QAAAA,GAAG,CAACC,aAAJ,GAAoBc,SAApB,CAA8BC,GAA9B;AACA;AACH;;AACD,SAAK,WAAL;AAAkB;AACd,YAAIC,QAAQ,GAAGjB,GAAG,CAACC,aAAJ,GAAoBiB,WAAnC;;AACA,YAAID,QAAJ,EAAc;AACVA,UAAAA,QAAQ,CAACE,KAAT,CAAeC,IAAf,CAAoB,CAApB,EAAuB,CAAvB,EAA0BC,OAA1B,GAAoC,mBAAmBJ,QAAQ,CAACE,KAAT,CAAeC,IAAf,CAAoB,CAApB,EAAuB,CAAvB,EAA0BC,OAAjF;AACH;;AACD;AACH;;AACD,SAAK,UAAL;AAAiB;AACb,YAAIrB,GAAG,CAACC,aAAJ,GAAoBc,SAApB,CAA8BO,KAA9B,GAAsC,CAA1C,EAA6C;AACzCC,UAAAA,KAAK,CAAC,eAAD,CAAL;AACA;AACH;;AAED,YAAIxB,IAAG,GAAGC,GAAG,CAACC,aAAJ,GAAoBC,cAA9B;AACA,YAAIH,IAAJ,EACIA,IAAG,CAACyB,KAAJ;AACJ;AACH;;AACD,SAAK,SAAL;AAAgB;AACZxB,QAAAA,GAAG,CAACyB,QAAJ,CAAaC,YAAb,CAA0B5B,KAA1B;AACA;AACH;AA9CL;AAiDH;;AAED,eAAe;AACXF,EAAAA,aAAa,EAAbA;AADW,CAAf","sourcesContent":["import Util from \"./util.js\"\r\n\r\nfunction onbuttonclick(idStr, param) {\r\n    switch (idStr) {\r\n        case \"getDocName\": {\r\n            let doc = wps.EtApplication().ActiveWorkbook\r\n            if (!doc) {\r\n                return \"当前没有打开任何文档\"\r\n            }\r\n            return doc.Name;\r\n        }\r\n        case \"createTaskPane\": {\r\n            let tsId = wps.PluginStorage.getItem(\"taskpane_id\")\r\n            if (!tsId) {\r\n                let tskpane = wps.CreateTaskPane(Util.GetUrlPath() + \"taskpane\")\r\n                let id = tskpane.ID\r\n                wps.PluginStorage.setItem(\"taskpane_id\", id)\r\n                tskpane.Visible = true\r\n            } else {\r\n                let tskpane = wps.GetTaskPane(tsId)\r\n                tskpane.Visible = true\r\n            }\r\n            break\r\n        }\r\n        case \"newDoc\": {\r\n            wps.EtApplication().Workbooks.Add()\r\n            break\r\n        }\r\n        case \"addString\": {\r\n            let curSheet = wps.EtApplication().ActiveSheet;\r\n            if (curSheet) {\r\n                curSheet.Cells.Item(1, 1).Formula = \"Hello, wps加载项!\" + curSheet.Cells.Item(1, 1).Formula\r\n            }\r\n            break;\r\n        }\r\n        case \"closeDoc\": {\r\n            if (wps.EtApplication().Workbooks.Count < 2) {\r\n                alert(\"当前只有一个文档，别关了。\")\r\n                break\r\n            }\r\n\r\n            let doc = wps.EtApplication().ActiveWorkbook\r\n            if (doc)\r\n                doc.Close()\r\n            break\r\n        }\r\n        case \"openWeb\": {\r\n            wps.OAAssist.ShellExecute(param)\r\n            break\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport default {\r\n    onbuttonclick\r\n}"]}]}