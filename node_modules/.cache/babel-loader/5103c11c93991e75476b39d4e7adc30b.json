{"remainingRequest":"E:\\tmp\\BossWps-Vue\\node_modules\\babel-loader\\lib\\index.js!E:\\tmp\\BossWps-Vue\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\tmp\\BossWps-Vue\\src\\components\\ribbon.js","dependencies":[{"path":"E:\\tmp\\BossWps-Vue\\src\\components\\ribbon.js","mtime":499162500000},{"path":"E:\\tmp\\BossWps-Vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\tmp\\BossWps-Vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\tmp\\BossWps-Vue\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90eXBlb2YgZnJvbSAiRTovdG1wL0Jvc3NXcHMtVnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90eXBlb2YiOwppbXBvcnQgVXRpbCBmcm9tICcuL2pzL3V0aWwuanMnOwppbXBvcnQgU3lzdGVtRGVtbyBmcm9tICcuL2pzL3N5c3RlbWRlbW8uanMnOyAvL+i/meS4quWHveaVsOWcqOaVtOS4qndwc+WKoOi9vemhueS4reaYr+esrOS4gOS4quaJp+ihjOeahAoKZnVuY3Rpb24gT25BZGRpbkxvYWQocmliYm9uVUkpIHsKICBpZiAoX3R5cGVvZih3cHMucmliYm9uVUkpICE9ICJvYmplY3QiKSB7CiAgICB3cHMucmliYm9uVUkgPSByaWJib25VSTsKICB9CgogIGlmIChfdHlwZW9mKHdwcy5FbnVtKSAhPSAib2JqZWN0IikgewogICAgLy8g5aaC5p6c5rKh5pyJ5YaF572u5p6a5Li+5YC8CiAgICB3cHMuRW51bSA9IFV0aWwuV1BTX0VudW07CiAgfSAvL+i/meWHoOS4quWvvOWHuuWHveaVsOaYr+e7meWklumDqOS4muWKoeezu+e7n+iwg+eUqOeahAoKCiAgd2luZG93Lm9wZW5PZmZpY2VGaWxlRnJvbVN5c3RlbURlbW8gPSBTeXN0ZW1EZW1vLm9wZW5PZmZpY2VGaWxlRnJvbVN5c3RlbURlbW87CiAgd2luZG93Lkludm9rZUZyb21TeXN0ZW1EZW1vID0gU3lzdGVtRGVtby5JbnZva2VGcm9tU3lzdGVtRGVtbzsKICB3cHMuUGx1Z2luU3RvcmFnZS5zZXRJdGVtKCJFbmFibGVGbGFnIiwgZmFsc2UpOyAvL+W+gFBsdWdpblN0b3JhZ2XkuK3orr7nva7kuIDkuKrmoIforrDvvIznlKjkuo7mjqfliLbkuKTkuKrmjInpkq7nmoTnva7ngbAKCiAgd3BzLlBsdWdpblN0b3JhZ2Uuc2V0SXRlbSgiQXBpRXZlbnRGbGFnIiwgZmFsc2UpOyAvL+W+gFBsdWdpblN0b3JhZ2XkuK3orr7nva7kuIDkuKrmoIforrDvvIznlKjkuo7mjqfliLZBcGlFdmVudOeahOaMiemSrmxhYmVsCgogIHJldHVybiB0cnVlOwp9Cgp2YXIgV2ViTm90aWZ5Y291bnQgPSAwOwoKZnVuY3Rpb24gT25BY3Rpb24oY29udHJvbCkgewogIHZhciBlbGVJZCA9IGNvbnRyb2wuSWQ7CgogIHN3aXRjaCAoZWxlSWQpIHsKICAgIGNhc2UgImJ0blNob3dNc2ciOgogICAgICB7CiAgICAgICAgdmFyIGRvYyA9IHdwcy5FdEFwcGxpY2F0aW9uKCkuQWN0aXZlV29ya2Jvb2s7CgogICAgICAgIGlmICghZG9jKSB7CiAgICAgICAgICBhbGVydCgi5b2T5YmN5rKh5pyJ5omT5byA5Lu75L2V5paH5qGjIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBhbGVydChkb2MuTmFtZSk7CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAiYnRuSXNFbmJhYmxlIjoKICAgICAgewogICAgICAgIHZhciBiRmxhZyA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oIkVuYWJsZUZsYWciKTsKICAgICAgICB3cHMuUGx1Z2luU3RvcmFnZS5zZXRJdGVtKCJFbmFibGVGbGFnIiwgIWJGbGFnKTsgLy/pgJrnn6V3cHPliLfmlrDku6XkuIvlh6DkuKrmjInppbDnmoTnirbmgIEKCiAgICAgICAgd3BzLnJpYmJvblVJLkludmFsaWRhdGVDb250cm9sKCJidG5Jc0VuYmFibGUiKTsKICAgICAgICB3cHMucmliYm9uVUkuSW52YWxpZGF0ZUNvbnRyb2woImJ0blNob3dEaWFsb2ciKTsKICAgICAgICB3cHMucmliYm9uVUkuSW52YWxpZGF0ZUNvbnRyb2woImJ0blNob3dUYXNrUGFuZSIpOyAvL3dwcy5yaWJib25VSS5JbnZhbGlkYXRlKCk7IOi/meihjOS7o+eggeaJk+W8gOWImeaYr+WIt+aWsOaJgOacieeahOaMiemSrueKtuaAgQoKICAgICAgICBicmVhazsKICAgICAgfQoKICAgIGNhc2UgImJ0blNob3dEaWFsb2ciOgogICAgICB3cHMuU2hvd0RpYWxvZyhVdGlsLkdldFVybFBhdGgoKSArICJkaWFsb2ciLCAi6L+Z5piv5LiA5Liq5a+56K+d5qGG572R6aG1IiwgNDAwICogd2luZG93LmRldmljZVBpeGVsUmF0aW8sIDQwMCAqIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLCBmYWxzZSk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgImJ0blNob3dUYXNrUGFuZSI6CiAgICAgIHsKICAgICAgICB2YXIgdHNJZCA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oInRhc2twYW5lX2lkIik7CgogICAgICAgIGlmICghdHNJZCkgewogICAgICAgICAgdmFyIHRza3BhbmUgPSB3cHMuQ3JlYXRlVGFza1BhbmUoVXRpbC5HZXRVcmxQYXRoKCkgKyAidGFza3BhbmUiKTsKICAgICAgICAgIHZhciBpZCA9IHRza3BhbmUuSUQ7CiAgICAgICAgICB3cHMuUGx1Z2luU3RvcmFnZS5zZXRJdGVtKCJ0YXNrcGFuZV9pZCIsIGlkKTsKICAgICAgICAgIHRza3BhbmUuVmlzaWJsZSA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBfdHNrcGFuZSA9IHdwcy5HZXRUYXNrUGFuZSh0c0lkKTsKCiAgICAgICAgICBfdHNrcGFuZS5WaXNpYmxlID0gIV90c2twYW5lLlZpc2libGU7CiAgICAgICAgfQogICAgICB9CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgImJ0bkFwaUV2ZW50IjoKICAgICAgewogICAgICAgIHZhciBfYkZsYWcgPSB3cHMuUGx1Z2luU3RvcmFnZS5nZXRJdGVtKCJBcGlFdmVudEZsYWciKTsKCiAgICAgICAgdmFyIGJSZWdpc3RlciA9IF9iRmxhZyA/IGZhbHNlIDogdHJ1ZTsKICAgICAgICB3cHMuUGx1Z2luU3RvcmFnZS5zZXRJdGVtKCJBcGlFdmVudEZsYWciLCBiUmVnaXN0ZXIpOwoKICAgICAgICBpZiAoYlJlZ2lzdGVyKSB7CiAgICAgICAgICB3cHMuQXBpRXZlbnQuQWRkQXBpRXZlbnRMaXN0ZW5lcignTmV3V29ya2Jvb2snLCAncmliYm9uLk9uTmV3RG9jdW1lbnRBcGlFdmVudCcpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3cHMuQXBpRXZlbnQuUmVtb3ZlQXBpRXZlbnRMaXN0ZW5lcignTmV3V29ya2Jvb2snLCAncmliYm9uLk9uTmV3RG9jdW1lbnRBcGlFdmVudCcpOwogICAgICAgIH0KCiAgICAgICAgd3BzLnJpYmJvblVJLkludmFsaWRhdGVDb250cm9sKCJidG5BcGlFdmVudCIpOwogICAgICB9CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgImJ0bldlYk5vdGlmeSI6CiAgICAgIHsKICAgICAgICB2YXIgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpOwogICAgICAgIHZhciB0aW1lU3RyID0gY3VycmVudFRpbWUuZ2V0SG91cnMoKSArICc6JyArIGN1cnJlbnRUaW1lLmdldE1pbnV0ZXMoKSArICI6IiArIGN1cnJlbnRUaW1lLmdldFNlY29uZHMoKTsKICAgICAgICB3cHMuT0FBc3Npc3QuV2ViTm90aWZ5KCLov5nooYzlhoXlrrnnlLF3cHPliqDovb3pobnkuLvliqjpgIHovr7nu5nkuJrliqHns7vnu5/vvIzlj6/ku6Xku7vmhI/oh6rlrprkuYksIOavlOWmguaXtumXtOWAvDoiICsgdGltZVN0ciArICLvvIzmrKHmlbDvvJoiICsgKytXZWJOb3RpZnljb3VudCwgdHJ1ZSk7CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgYnJlYWs7CiAgfQoKICByZXR1cm4gdHJ1ZTsKfQoKZnVuY3Rpb24gR2V0SW1hZ2UoY29udHJvbCkgewogIHZhciBlbGVJZCA9IGNvbnRyb2wuSWQ7CgogIHN3aXRjaCAoZWxlSWQpIHsKICAgIGNhc2UgImJ0blNob3dNc2ciOgogICAgICByZXR1cm4gImltYWdlcy8xLnN2ZyI7CgogICAgY2FzZSAiYnRuU2hvd0RpYWxvZyI6CiAgICAgIHJldHVybiAiaW1hZ2VzLzIuc3ZnIjsKCiAgICBjYXNlICJidG5TaG93VGFza1BhbmUiOgogICAgICByZXR1cm4gImltYWdlcy8zLnN2ZyI7CgogICAgZGVmYXVsdDoKICB9CgogIHJldHVybiAiaW1hZ2VzL25ld0Zyb21UZW1wLnN2ZyI7Cn0KCmZ1bmN0aW9uIE9uR2V0RW5hYmxlZChjb250cm9sKSB7CiAgdmFyIGVsZUlkID0gY29udHJvbC5JZDsKCiAgc3dpdGNoIChlbGVJZCkgewogICAgY2FzZSAiYnRuU2hvd01zZyI6CiAgICAgIHJldHVybiB0cnVlOwoKICAgIGNhc2UgImJ0blNob3dEaWFsb2ciOgogICAgICB7CiAgICAgICAgdmFyIGJGbGFnID0gd3BzLlBsdWdpblN0b3JhZ2UuZ2V0SXRlbSgiRW5hYmxlRmxhZyIpOwogICAgICAgIHJldHVybiBiRmxhZzsKICAgICAgfQoKICAgIGNhc2UgImJ0blNob3dUYXNrUGFuZSI6CiAgICAgIHsKICAgICAgICB2YXIgX2JGbGFnMiA9IHdwcy5QbHVnaW5TdG9yYWdlLmdldEl0ZW0oIkVuYWJsZUZsYWciKTsKCiAgICAgICAgcmV0dXJuIF9iRmxhZzI7CiAgICAgIH0KCiAgICBkZWZhdWx0OgogICAgICBicmVhazsKICB9CgogIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBPbkdldFZpc2libGUoY29udHJvbCkgewogIHZhciBlbGVJZCA9IGNvbnRyb2wuSWQ7CiAgY29uc29sZS5sb2coZWxlSWQpOwogIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBPbkdldExhYmVsKGNvbnRyb2wpIHsKICB2YXIgZWxlSWQgPSBjb250cm9sLklkOwoKICBzd2l0Y2ggKGVsZUlkKSB7CiAgICBjYXNlICJidG5Jc0VuYmFibGUiOgogICAgICB7CiAgICAgICAgdmFyIGJGbGFnID0gd3BzLlBsdWdpblN0b3JhZ2UuZ2V0SXRlbSgiRW5hYmxlRmxhZyIpOwogICAgICAgIHJldHVybiBiRmxhZyA/ICLmjInpkq5EaXNhYmxlIiA6ICLmjInpkq5FbmFibGUiOwogICAgICB9CgogICAgY2FzZSAiYnRuQXBpRXZlbnQiOgogICAgICB7CiAgICAgICAgdmFyIF9iRmxhZzMgPSB3cHMuUGx1Z2luU3RvcmFnZS5nZXRJdGVtKCJBcGlFdmVudEZsYWciKTsKCiAgICAgICAgcmV0dXJuIF9iRmxhZzMgPyAi5riF6Zmk5paw5bu65paH5Lu25LqL5Lu2IiA6ICLms6jlhozmlrDlu7rmlofku7bkuovku7YiOwogICAgICB9CiAgfQoKICByZXR1cm4gIiI7Cn0KCmZ1bmN0aW9uIE9uTmV3RG9jdW1lbnRBcGlFdmVudChkb2MpIHsKICBhbGVydCgi5paw5bu65paH5Lu25LqL5Lu25ZON5bqU77yM5Y+W5paH5Lu25ZCNOiAiICsgZG9jLk5hbWUpOwp9IC8v6L+Z5Lqb5Ye95pWw5piv57uZd3Bz5a6i5oi356uv6LCD55So55qECgoKZXhwb3J0IGRlZmF1bHQgewogIE9uQWRkaW5Mb2FkOiBPbkFkZGluTG9hZCwKICBPbkFjdGlvbjogT25BY3Rpb24sCiAgR2V0SW1hZ2U6IEdldEltYWdlLAogIE9uR2V0RW5hYmxlZDogT25HZXRFbmFibGVkLAogIE9uR2V0VmlzaWJsZTogT25HZXRWaXNpYmxlLAogIE9uR2V0TGFiZWw6IE9uR2V0TGFiZWwsCiAgT25OZXdEb2N1bWVudEFwaUV2ZW50OiBPbk5ld0RvY3VtZW50QXBpRXZlbnQKfTs="},{"version":3,"sources":["E:/tmp/BossWps-Vue/src/components/ribbon.js"],"names":["Util","SystemDemo","OnAddinLoad","ribbonUI","wps","Enum","WPS_Enum","window","openOfficeFileFromSystemDemo","InvokeFromSystemDemo","PluginStorage","setItem","WebNotifycount","OnAction","control","eleId","Id","doc","EtApplication","ActiveWorkbook","alert","Name","bFlag","getItem","InvalidateControl","ShowDialog","GetUrlPath","devicePixelRatio","tsId","tskpane","CreateTaskPane","id","ID","Visible","GetTaskPane","bRegister","ApiEvent","AddApiEventListener","RemoveApiEventListener","currentTime","Date","timeStr","getHours","getMinutes","getSeconds","OAAssist","WebNotify","GetImage","OnGetEnabled","OnGetVisible","console","log","OnGetLabel","OnNewDocumentApiEvent"],"mappings":"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","sourcesContent":["import Util from './js/util.js'\nimport SystemDemo from './js/systemdemo.js'\n\n//这个函数在整个wps加载项中是第一个执行的\nfunction OnAddinLoad(ribbonUI){\n    if (typeof (wps.ribbonUI) != \"object\"){\n\t\twps.ribbonUI = ribbonUI\n    }\n    \n    if (typeof (wps.Enum) != \"object\") { // 如果没有内置枚举值\n        wps.Enum = Util.WPS_Enum\n    }\n\n    //这几个导出函数是给外部业务系统调用的\n    window.openOfficeFileFromSystemDemo = SystemDemo.openOfficeFileFromSystemDemo\n    window.InvokeFromSystemDemo = SystemDemo.InvokeFromSystemDemo\n\n    wps.PluginStorage.setItem(\"EnableFlag\", false) //往PluginStorage中设置一个标记，用于控制两个按钮的置灰\n    wps.PluginStorage.setItem(\"ApiEventFlag\", false) //往PluginStorage中设置一个标记，用于控制ApiEvent的按钮label\n    return true\n}\n\nvar WebNotifycount = 0;\nfunction OnAction(control) {\n    const eleId = control.Id\n    switch (eleId) {\n        case \"btnShowMsg\":\n            {\n                const doc = wps.EtApplication().ActiveWorkbook\n                if (!doc) {\n                    alert(\"当前没有打开任何文档\")\n                    return\n                }\n                alert(doc.Name)\n            }\n            break;\n        case \"btnIsEnbable\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                wps.PluginStorage.setItem(\"EnableFlag\", !bFlag)\n                \n                //通知wps刷新以下几个按饰的状态\n                wps.ribbonUI.InvalidateControl(\"btnIsEnbable\")\n                wps.ribbonUI.InvalidateControl(\"btnShowDialog\") \n                wps.ribbonUI.InvalidateControl(\"btnShowTaskPane\") \n                //wps.ribbonUI.Invalidate(); 这行代码打开则是刷新所有的按钮状态\n                break\n            }\n        case \"btnShowDialog\":\n            wps.ShowDialog(Util.GetUrlPath() + \"dialog\", \"这是一个对话框网页\", 400 * window.devicePixelRatio, 400 * window.devicePixelRatio, false)\n            break\n        case \"btnShowTaskPane\":\n            {\n                let tsId = wps.PluginStorage.getItem(\"taskpane_id\")\n                if (!tsId) {\n                    let tskpane = wps.CreateTaskPane(Util.GetUrlPath() + \"taskpane\")\n                    let id = tskpane.ID\n                    wps.PluginStorage.setItem(\"taskpane_id\", id)\n                    tskpane.Visible = true\n                } else {\n                    let tskpane = wps.GetTaskPane(tsId)\n                    tskpane.Visible = !tskpane.Visible\n                }\n            }\n            break\n        case \"btnApiEvent\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"ApiEventFlag\")\n                let bRegister = bFlag ? false : true\n                wps.PluginStorage.setItem(\"ApiEventFlag\", bRegister)\n                if (bRegister){\n                    wps.ApiEvent.AddApiEventListener('NewWorkbook', 'ribbon.OnNewDocumentApiEvent')\n                }\n                else{\n                    wps.ApiEvent.RemoveApiEventListener('NewWorkbook', 'ribbon.OnNewDocumentApiEvent')\n                }\n                \n                wps.ribbonUI.InvalidateControl(\"btnApiEvent\") \n            }\n            break\n        case \"btnWebNotify\":\n            {\n                let currentTime = new Date()\n                let timeStr = currentTime.getHours() + ':' + currentTime.getMinutes() + \":\" + currentTime.getSeconds()\n                wps.OAAssist.WebNotify(\"这行内容由wps加载项主动送达给业务系统，可以任意自定义, 比如时间值:\" + timeStr + \"，次数：\" + (++WebNotifycount), true)\n            }\n            break\n        default:\n            break\n    }\n    return true\n}\n\nfunction GetImage(control) {\n    const eleId = control.Id\n    switch (eleId) {\n        case \"btnShowMsg\":\n            return \"images/1.svg\"\n        case \"btnShowDialog\":\n            return \"images/2.svg\"\n        case \"btnShowTaskPane\":\n            return \"images/3.svg\"\n        default:\n    }\n    return \"images/newFromTemp.svg\"\n}\n\nfunction OnGetEnabled(control) {\n    const eleId = control.Id\n    switch (eleId) {\n        case \"btnShowMsg\":\n            return true\n        case \"btnShowDialog\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                return bFlag\n            }\n        case \"btnShowTaskPane\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                return bFlag\n            }\n        default:\n            break\n    }\n    return true\n}\n\nfunction OnGetVisible(control){\n    const eleId = control.Id\n    console.log(eleId)\n    return true\n}\n\nfunction OnGetLabel(control){\n    const eleId = control.Id\n    switch (eleId) {\n        case \"btnIsEnbable\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"EnableFlag\")\n                return bFlag ?  \"按钮Disable\" : \"按钮Enable\"\n            }\n        case \"btnApiEvent\":\n            {\n                let bFlag = wps.PluginStorage.getItem(\"ApiEventFlag\")\n                return bFlag ? \"清除新建文件事件\" : \"注册新建文件事件\"\n            }    \n    }\n    return \"\"\n}\n\nfunction OnNewDocumentApiEvent(doc){\n    alert(\"新建文件事件响应，取文件名: \" + doc.Name)\n}\n\n//这些函数是给wps客户端调用的\nexport default {\n    OnAddinLoad,\n    OnAction,\n    GetImage,\n    OnGetEnabled,\n    OnGetVisible,\n    OnGetLabel,\n    OnNewDocumentApiEvent\n};\n"]}]}